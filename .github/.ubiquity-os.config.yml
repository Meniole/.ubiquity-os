# 
walletWith: &walletWith
  registerWalletWithVerification: false

conversationRewardsWith: &conversationRewardsWith
  logLevel: "debug"
  evmNetworkId: 100
  evmPrivateEncrypted: "CfuT-byEUxpZYTwp_DSwCUuIIooaqTI2oWmZtVEsLBk34iYFU7qjhT9mM9HGbgRhurUt-4l51kygfQIUwvYkCi2acpTPxSHTsFQBrZOScll5XvOu-nEwxtKnUhhxXgXTjdE"
  incentives:
    requirePriceLabel: true
    contentEvaluator:
      openAi:
        endpoint: "https://api.groq.com/openai/v1"
        model: "llama3-groq-70b-8192-tool-use-preview"
    userExtractor:
      redeemTask: true
    dataPurge: {}
    formattingEvaluator: {}
    permitGeneration:
      enabled: true
    githubComment:
      post: true
      debug: false

daemonPricingWith: &daemonPricingWith
  labels:
    time:
      - name: "Time: <1 Hour"
        collaboratorOnly: true
      - name: "Time: <2 Hours"
        collaboratorOnly: false
      - name: "Time: <4 Hours"
        collaboratorOnly: false
      - name: "Time: <1 Day"
        collaboratorOnly: false
      - name: "Time: <1 Week"
        collaboratorOnly: true
    priority:
      - name: "Priority: 1 (Normal)"
        collaboratorOnly: false
      - name: "Priority: 2 (Medium)"
        collaboratorOnly: false
      - name: "Priority: 3 (High)"
        collaboratorOnly: true
      - name: "Priority: 4 (Urgent)"
        collaboratorOnly: false
      - name: "Priority: 5 (Emergency)"
        collaboratorOnly: true
  basePriceMultiplier: 3
  globalConfigUpdate:
    excludeRepos: []
  publicAccessControl:
    setLabel: true
    fundExternalClosedIssue: false

startStopWith: &startStopWith
  assignedIssueScope: "network"
  reviewDelayTolerance: "1 minute"
  taskStaleTimeoutDuration: "1 minute"
  maxConcurrentTasks:
    member: 1
    contributor: 1
  startRequiresWallet: false
  rolesWithReviewAuthority:
    - "OWNER"
    - "MEMBER"
  requiredLabelsToStart: ["Priority: 5 (Emergency)"]

telegramWith: &telegramWith
  botId: 5112548588

disqualifierWith: &disqualifierWith
  disqualification: "2 minutes"
  warning: "1 minute"
  watch:
    optOut:
      - "repoName"
      - "repoName2"

# plugins:
  # - uses:
  #   - plugin: http://localhost:4001
  #     with: *daemonPricingWith
  # - uses:
  #   - plugin: Meniole/daemon-disqualifier@development
  #     with: *disqualifierWith
  # - skipBotEvents: false
  #   uses:
  #     - plugin: http://localhost:4000
  #       with: *startStopWith
  
  # - uses:
  #   - plugin: Meniole/daemon-pricing@feat/label-gating
  #   # - plugin: https://ubiquity-os-daemon-pricing-feat-label-gating.fernand-veyrier.workers.dev  
  #     with: *daemonPricingWith
  # - uses:
  #   - plugin: Meniole/automated-merging@feat/schema-validation
  #     with:
  #       approvalsRequired:
  #         collaborator: "10"
  #       mergeTimeout:
  #         collaborator: "2 minutes"
  #       repos:
  #         monitor: [ ]
  #         ignore: ["conversation-rewards"]
  #       allowedReviewerRoles: ["OWNER", "COLLABORATOR", true]
  # - uses:
  #   - plugin: https://ubiquibot-command-wallet-development.fernand-veyrier.workers.dev
  #     with:
  #       registerWalletWithVerification: false
  # - uses:
  #   - plugin: https://command-query-user-development.fernand-veyrier.workers.dev
  #     with:
  #       allowPublicQuery: true
  # - uses:
  #   - plugin: Meniole/assistive-pricing@fork/ubq-testing/development
  #     with:
  #       labels:
  #         time:
  #           - name: "Time: <1.5 Minutes"
  #             collaboratorOnly: true
  #           - name: "Time: <1 Hour"
  #           - name: "Time: <2 Hours"
  #             collaboratorOnly: false
  #           - name: "Time: <4 Hours"
  #           - name: "Time: <1 Day"
  #             collaboratorOnly: true
  #           - name: "Time: <1 Week"
  #             collaboratorOnly: true
  #         priority:
  #           - name: "Priority: 1 (Normal)"
  #             collaboratorOnly: false
  #           - name: "Priority: 2 (Medium)"
  #             collaboratorOnly: true
  #           - name: "Priority: 3 (High)"
  #             collaboratorOnly: true
  #           - name: "Priority: 4 (Urgent)"
  #             collaboratorOnly: true
  #           - name: "Priority: 5 (Emergency)"
  #       basePriceMultiplier: 2
  #       globalConfigUpdate:
  #         excludeRepos: []
  #       publicAccessControl:
  #         setLabel: true
  #         fundExternalClosedIssue: false
  # - skipBotEvents: false
  # - uses:
  #   - plugin: https://ubiquibot-command-start-stop-development.fernand-veyrier.workers.dev
  #     with: *startStopWith
  # - uses:
  #   - plugin: Meniole/text-conversation-rewards@development
  #     with: *conversationRewardsWith
plugins:
  - uses:
    - plugin: https://ubiquity-os-comment-vector-embeddings-development.fernand-veyrier.workers.dev
      with:
        matchThreshold: 0.95
        warningThreshold: 0.75
        jobMatchingThreshold: 0.75
  - uses:
    - plugin: https://ubiquibot-command-wallet-development.fernand-veyrier.workers.dev
      with:
        registerWalletWithVerification: false
  - uses:
    - plugin: https://command-query-user-development.fernand-veyrier.workers.dev
      with:
        allowPublicQuery: true
  - uses:
    - plugin: https://ubiquibot-assistive-pricing-development.fernand-veyrier.workers.dev
      with:
        labels:
          time:
            - "Time: <15 Minutes"
            - "Time: <1 Hour"
            - "Time: <2 Hours"
            - "Time: <4 Hours"
            - "Time: <1 Day"
            - "Time: <1 Week"
            - "Time: <2 Weeks"
            - "Time: <1 Month"
          priority:
            - "Priority: 1 (Normal)"
            - "Priority: 2 (Medium)"
            - "Priority: 3 (High)"
            - "Priority: 4 (Urgent)"
            - "Priority: 5 (Emergency)"
        basePriceMultiplier: 2
        publicAccessControl:
          setLabel: true
          fundExternalClosedIssue: false
  - uses:
    - plugin: Meniole/text-conversation-rewards@development
      skipBotEvents: false
      with:
        logLevel: "debug"
        evmNetworkId: 100
        evmPrivateEncrypted: "gdo_iiUND1poZaibNme5oUsG1g8RDEmtI41uLgZjxW8WwxnQZb0DHkOBcISuwobxyKEyzeGQC9KzjkWXv0_OCv-kuUHy4myWNIhs4j3odyvh1XUP7pZFeuVEiASmKQBGkzlKRii5dA0liXtHnhciZQi5N8E7-cdOMbA" # https://github.com/ubiquibot/conversation-rewards/pull/111#issuecomment-2348639931
        erc20RewardToken: "0xe91D153E0b41518A2Ce8Dd3D7944Fa863463a97d"
        incentives:
          requirePriceLabel: true
          contentEvaluator: {}
          userExtractor:
            enabled: true
            redeemTask: true
          dataPurge: {}
          formattingEvaluator:
            multipliers:
              - role:
                - ISSUE_SPECIFICATION
                multiplier: 3
                rewards:
                  wordValue: 0.1
                  html:
                    br:
                      score: 0
                      countWords: true
                    code:
                      score: 5
                      countWords: false
                    p:
                      score: 0
                      countWords: true
                    em:
                      score: 0
                      countWords: true
                    img:
                      score: 5
                      countWords: true
                    strong:
                      score: 0
                      countWords: false
                    blockquote:
                      score: 0
                      countWords: false
                    h1:
                      score: 1
                      countWords: true
                    h2:
                      score: 1
                      countWords: true
                    h3:
                      score: 1
                      countWords: true
                    h4:
                      score: 1
                      countWords: true
                    h5:
                      score: 1
                      countWords: true
                    h6:
                      score: 1
                      countWords: true
                    a:
                      score: 5
                      countWords: true
                    li:
                      score: 0.5
                      countWords: true
                    ul:
                      score: 0
                      countWords: true
                    td:
                      score: 0
                      countWords: true
                    hr:
                      score: 0
                      countWords: true
                    pre:
                      score: 0
                      countWords: false
                    ol:
                      score: 0
                      countWords: true
              - role:
                - ISSUE_AUTHOR
                - ISSUE_COLLABORATOR
                - PULL_COLLABORATOR
                multiplier: 1
                rewards:
                  wordValue: 0.1
                  html:
                    br:
                      score: 0
                      countWords: true
                    code:
                      score: 5
                      countWords: false
                    p:
                      score: 0
                      countWords: true
                    em:
                      score: 0
                      countWords: true
                    img:
                      score: 5
                      countWords: true
                    strong:
                      score: 0
                      countWords: false
                    blockquote:
                      score: 0
                      countWords: false
                    h1:
                      score: 1
                      countWords: true
                    h2:
                      score: 1
                      countWords: true
                    h3:
                      score: 1
                      countWords: true
                    h4:
                      score: 1
                      countWords: true
                    h5:
                      score: 1
                      countWords: true
                    h6:
                      score: 1
                      countWords: true
                    a:
                      score: 5
                      countWords: true
                    li:
                      score: 0.5
                      countWords: true
                    ul:
                      score: 0
                      countWords: true
                    td:
                      score: 0
                      countWords: true
                    hr:
                      score: 0
                      countWords: true
                    pre:
                      score: 0
                      countWords: false
                    ol:
                      score: 0
                      countWords: true
              - role:
                - ISSUE_CONTRIBUTOR
                - ISSUE_ASSIGNEE
                multiplier: 0.25
                rewards:
                  wordValue: 0.1
                  html:
                    br:
                      score: 0
                      countWords: true
                    code:
                      score: 5
                      countWords: false
                    p:
                      score: 0
                      countWords: true
                    em:
                      score: 0
                      countWords: true
                    img:
                      score: 5
                      countWords: true
                    strong:
                      score: 0
                      countWords: false
                    blockquote:
                      score: 0
                      countWords: false
                    h1:
                      score: 1
                      countWords: true
                    h2:
                      score: 1
                      countWords: true
                    h3:
                      score: 1
                      countWords: true
                    h4:
                      score: 1
                      countWords: true
                    h5:
                      score: 1
                      countWords: true
                    h6:
                      score: 1
                      countWords: true
                    a:
                      score: 5
                      countWords: true
                    li:
                      score: 0.5
                      countWords: true
                    ul:
                      score: 0
                      countWords: true
                    td:
                      score: 0
                      countWords: true
                    hr:
                      score: 0
                      countWords: true
                    pre:
                      score: 0
                      countWords: false
                    ol:
                      score: 0
                      countWords: true
              - role:
                - PULL_SPECIFICATION
                - PULL_AUTHOR
                - PULL_CONTRIBUTOR
                - PULL_ASSIGNEE
                multiplier: 0
                rewards:
                  wordValue: 0
                  html:
                    br:
                      score: 0
                      countWords: true
                    code:
                      score: 5
                      countWords: false
                    p:
                      score: 0
                      countWords: true
                    em:
                      score: 0
                      countWords: true
                    img:
                      score: 5
                      countWords: true
                    strong:
                      score: 0
                      countWords: false
                    blockquote:
                      score: 0
                      countWords: false
                    h1:
                      score: 1
                      countWords: true
                    h2:
                      score: 1
                      countWords: true
                    h3:
                      score: 1
                      countWords: true
                    h4:
                      score: 1
                      countWords: true
                    h5:
                      score: 1
                      countWords: true
                    h6:
                      score: 1
                      countWords: true
                    a:
                      score: 5
                      countWords: true
                    li:
                      score: 0.5
                      countWords: true
                    ul:
                      score: 0
                      countWords: true
                    td:
                      score: 0
                      countWords: true
                    hr:
                      score: 0
                      countWords: true
                    pre:
                      score: 0
                      countWords: false
                    ol:
                      score: 0
                      countWords: true
            wordCountExponent: 0.85
          permitGeneration:
            enabled: true
          githubComment:
            post: true
            debug: false
        dataCollection:
          maxAttempts: 10
          delayMs: 1000
  - uses:
    - plugin: Meniole/daemon-disqualifier@development
      with:
        warning: "7 days"
        disqualification: "14 days"
        eventWhitelist:
          - "pull_request.review_requested"
          - "pull_request.ready_for_review"
          - "pull_request_review_comment.created"
          - "issue_comment.created"
          - "push"
        watch:
          optOut:
            - ubiquibot
            - launch-party
            - staging
            - production
  - uses:
    - plugin: Meniole/daemon-merging@development
      with:
        approvalsRequired:
          collaborator: 1
          contributor: 2
        mergeTimeout:
          collaborator: "3.5 days"
          contributor: "7 days"
        repos:
          monitor: []
          ignore:
            - ubiquibot
            - launch-party
            - staging
            - production
        allowedReviewerRoles:
          - COLLABORATOR
          - MEMBER
          - OWNER
  - skipBotEvents: false
    uses:
      - plugin: https://command-start-stop-development.fernand-veyrier.workers.dev
        with:
          reviewDelayTolerance: "3 Days"
          taskStaleTimeoutDuration: "30 Days"
          startRequiresWallet: true
          maxConcurrentTasks:
            member: 2
            contributor: 2
          emptyWalletText: "Please set your wallet address with the /wallet command first and try again."
          rolesWithReviewAuthority:
            - COLLABORATOR
            - OWNER
            - MEMBER
            - ADMIN
          requiredLabelsToStart: ["Priority: 3 (High)", "Priority: 4 (Urgent)", "Priority: 5 (Emergency)"]
  - uses:
      - plugin: Meniole/ubiquity-os-kernel-telegram@development
        with:
          botId: 5112548588
  - uses:
      - plugin: https://ubiquity-os-telegram-bridge-development.ubiquity.workers.dev
        with:
          botId: 5112548588
  - uses:
    - plugin: Meniole/command-ask@development
      with:
        model: "openai/o1-mini"
        openAiBaseUrl: "https://openrouter.ai/api/v1"
